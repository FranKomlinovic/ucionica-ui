<p-toast></p-toast>
<app-spinner [visible]="spinnerOn"></app-spinner>

<h1>Posljednje uplate</h1>
<!-- Open form button -->
<p-button
  (click)="this.displayDialog = true"
  icon="pi pi-external-link"
  label="Dodaj uplatu"
></p-button>

<!-- Dialog -->
<p-dialog header="Dodaj uplatu" [(visible)]="displayDialog">
  <h5>Korisnik</h5>
  <p-autoComplete
    [(ngModel)]="selectedUserAdvanced"
    [suggestions]="filteredUsers"
    (completeMethod)="filterPayments($event)"
    field="username"
    [dropdown]="true"
  >
    <ng-template let-user pTemplate="item">
      <div>
        <div>{{ user.username }}</div>
      </div>
    </ng-template>
  </p-autoComplete>

  <h5>Iznos</h5>
  <p-inputNumber
    [(ngModel)]="amount"
    mode="currency"
    currency="HRK"
    locale="de-DE"
  >
  </p-inputNumber>

  <ng-template pTemplate="footer">
    <p-button
      icon="pi pi-plus"
      (click)="savePayment()"
      label="Kreiraj"
    ></p-button>
  </ng-template>
</p-dialog>

<!-- Grid -->
<div class="grid">
  <div *ngFor="let payment of lastPayments">
    <div class="col flex align-items-center justify-content-center m-3">
      <p-card
        header="{{ payment.user }}"
        subheader="{{ payment.time }}"
        [style]="{ width: '230px' }"
        styleClass="p-card-shadow"
      >
        <ng-template pTemplate="header">
          <img alt="Card" src="{{ payment.picture }}" />
        </ng-template>
        <div>
          {{ payment.amount }}
        </div>
        <p-confirmDialog></p-confirmDialog>
        <ng-template pTemplate="footer">
          <p-button
            icon="pi pi-trash"
            styleClass="p-button-danger"
            (click)="confirm(payment.id)"
          >
          </p-button>
        </ng-template>
      </p-card>
    </div>
  </div>
</div>
